<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Female Speakers in Swedish Drama</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            text-align: center;
            margin-bottom: 30px;
            font-size: 1.1em;
            color: #666;
        }
        
        .chart-container {
            position: relative;
            margin: 20px 0;
        }
        
        .axis {
            font-size: 12px;
        }
        
        .axis-label {
            font-size: 14px;
            font-weight: bold;
            fill: #444;
        }
        
        .grid-line {
            stroke: #e0e0e0;
            stroke-width: 1;
            stroke-dasharray: 2,2;
        }
        
        .trend-line {
            fill: none;
            stroke: #ff6b6b;
            stroke-width: 3;
            stroke-linecap: round;
            filter: drop-shadow(0 2px 4px rgba(255, 107, 107, 0.3));
        }
        
        .data-point {
            fill: #4ecdc4;
            stroke: #fff;
            stroke-width: 2;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .data-point:hover {
            fill: #45b7aa;
            stroke-width: 3;
            filter: drop-shadow(0 4px 8px rgba(78, 205, 196, 0.5));
        }
        
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .stats-container {
            display: flex;
            justify-content: space-around;
            margin-top: 30px;
            gap: 20px;
        }
        
        .stat-box {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            flex: 1;
            box-shadow: 0 8px 20px rgba(78, 205, 196, 0.3);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 4px;
            border-radius: 2px;
        }
        
        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        
        .play-list {
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
        }
        
        .play-item {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
            font-size: 0.9em;
        }
        
        .play-item:last-child {
            border-bottom: none;
        }
        
        .play-title {
            font-weight: bold;
            color: #667eea;
        }
        
        .play-author {
            color: #666;
            font-size: 0.85em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Female Speakers in Swedish Drama</h1>
        <p class="subtitle">Analyzing gender representation in the Swedish Drama Corpus (SweDraCor) from 1880-1900</p>
        
        <div class="chart-container">
            <svg id="chart"></svg>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #4ecdc4;"></div>
                <span>Individual Plays</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #ff6b6b;"></div>
                <span>Trend Line</span>
            </div>
        </div>
        
        <div class="stats-container">
            <div class="stat-box">
                <div class="stat-number" id="avg-percentage">-</div>
                <div class="stat-label">Average % Female Speakers</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="total-plays">-</div>
                <div class="stat-label">Total Plays</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="year-range">-</div>
                <div class="stat-label">Year Range</div>
            </div>
        </div>
        
        <div class="info-box">
            <strong>About the Data:</strong> This analysis is based on the Swedish Drama Corpus (SweDraCor), which contains 68 Swedish plays from approximately 1880 to 1900. The corpus includes works by notable authors such as August Strindberg, Anne Charlotte Leffler, and Alfhild Agrell. The percentage of female speakers is calculated as the number of female characters divided by the total number of speaking characters in each play.
        </div>
        
        <div class="play-list" id="play-list">
            <h3>All Plays in the Corpus</h3>
            <div id="plays-content"></div>
        </div>
        
        <div class="tooltip" id="tooltip"></div>
    </div>

    <script>
        // Data from the Swedish Drama Corpus
        const plays = [
            {title: "Dömd", author: "Agrell", year: 1884, femaleCount: 8, totalCount: 15},
            {title: "En hufvudsak", author: "Agrell", year: 1883, femaleCount: 3, totalCount: 4},
            {title: "En lektion", author: "Agrell", year: 1884, femaleCount: 1, totalCount: 2},
            {title: "Ensam", author: "Agrell", year: 1886, femaleCount: 3, totalCount: 7},
            {title: "Hvarför?", author: "Agrell", year: 1883, femaleCount: 3, totalCount: 4},
            {title: "Ingrid: En döds kärlekssaga", author: "Agrell", year: 1900, femaleCount: 6, totalCount: 14},
            {title: "Småstadslif", author: "Agrell", year: 1884, femaleCount: 9, totalCount: 19},
            {title: "Farmors födelsedag", author: "Aurelius", year: 1897, femaleCount: 7, totalCount: 12},
            {title: "Efterspel", author: "Barthelson", year: 1885, femaleCount: 4, totalCount: 10},
            {title: "Final", author: "Benedictsson", year: 1885, femaleCount: 6, totalCount: 20},
            {title: "I telefon", author: "Benedictsson", year: 1887, femaleCount: 5, totalCount: 8},
            {title: "Romeos Julia", author: "Benedictsson", year: 1889, femaleCount: 1, totalCount: 6},
            {title: "Konstnärns förtviflan", author: "Bremer", year: 1887, femaleCount: 1, totalCount: 2},
            {title: "Lars Anders och Jan Anders och deras barn", author: "Geijerstam", year: 1894, femaleCount: 4, totalCount: 13},
            {title: "Rospiggarna", author: "Hedberg", year: 1884, femaleCount: 11, totalCount: 37},
            {title: "I det gröna", author: "Indebetou", year: 1896, femaleCount: 6, totalCount: 11},
            {title: "I fruntimmersveckan", author: "Indebetou", year: 1895, femaleCount: 4, totalCount: 6},
            {title: "På fotvandring", author: "Indebetou", year: 1897, femaleCount: 4, totalCount: 7},
            {title: "Kärlek", author: "Kullgren", year: 1885, femaleCount: 5, totalCount: 8},
            {title: "När nyår kom", author: "Kuylenstierna", year: 1899, femaleCount: 3, totalCount: 9},
            {title: "Nu är det jul igen", author: "Kuylenstierna", year: 1899, femaleCount: 2, totalCount: 6},
            {title: "Den kärleken!", author: "Leffler", year: 1891, femaleCount: 4, totalCount: 6},
            {title: "Elfvan", author: "Leffler", year: 1883, femaleCount: 10, totalCount: 14},
            {title: "Familjelycka", author: "Leffler", year: 1891, femaleCount: 7, totalCount: 9},
            {title: "Hur man gör godt", author: "Leffler", year: 1885, femaleCount: 19, totalCount: 41},
            {title: "Moster Malvina", author: "Leffler", year: 1891, femaleCount: 8, totalCount: 9},
            {title: "Sanna kvinnor", author: "Leffler", year: 1883, femaleCount: 4, totalCount: 7},
            {title: "Skådespelerskan", author: "Leffler", year: 1883, femaleCount: 5, totalCount: 10},
            {title: "Under toffeln", author: "Leffler", year: 1883, femaleCount: 3, totalCount: 5},
            {title: "Mödrar", author: "Lindhé", year: 1887, femaleCount: 7, totalCount: 10},
            {title: "Förlåt mig!", author: "Lundberg", year: 1886, femaleCount: 1, totalCount: 3},
            {title: "Fru Leonora", author: "Malling", year: 1897, femaleCount: 5, totalCount: 10},
            {title: "Otteringning", author: "Marholm", year: 1896, femaleCount: 2, totalCount: 3},
            {title: "Den nya klassen", author: "Meyerson", year: 1897, femaleCount: 5, totalCount: 14},
            {title: "Ett pojkstreck", author: "Meyerson", year: 1896, femaleCount: 3, totalCount: 7},
            {title: "Vårflod", author: "Molander", year: 1884, femaleCount: 5, totalCount: 8},
            {title: "Anno fyrtiåtta", author: "Strindberg", year: 1881, femaleCount: 5, totalCount: 20},
            {title: "Bandet", author: "Strindberg", year: 1897, femaleCount: 3, totalCount: 24},
            {title: "Den starkare", author: "Strindberg", year: 1890, femaleCount: 3, totalCount: 3},
            {title: "Fadren", author: "Strindberg", year: 1887, femaleCount: 4, totalCount: 9},
            {title: "Fordringsegare", author: "Strindberg", year: 1890, femaleCount: 1, totalCount: 3},
            {title: "Första varningen", author: "Strindberg", year: 1893, femaleCount: 4, totalCount: 5},
            {title: "Fröken Julie", author: "Strindberg", year: 1888, femaleCount: 2, totalCount: 4},
            {title: "Gillets hemlighet", author: "Strindberg", year: 1880, femaleCount: 3, totalCount: 17},
            {title: "Herr Bengts hustru", author: "Strindberg", year: 1882, femaleCount: 9, totalCount: 16},
            {title: "Höstslask", author: "Strindberg", year: 1884, femaleCount: 0, totalCount: 8},
            {title: "Inför döden", author: "Strindberg", year: 1893, femaleCount: 3, totalCount: 6},
            {title: "Kamraterna", author: "Strindberg", year: 1888, femaleCount: 5, totalCount: 13},
            {title: "Lycko-Pers resa", author: "Strindberg", year: 1882, femaleCount: 7, totalCount: 43},
            {title: "Marodörer", author: "Strindberg", year: 1886, femaleCount: 6, totalCount: 11},
            {title: "Mäster Olof", author: "Strindberg", year: 1881, femaleCount: 6, totalCount: 35},
            {title: "Moderskärlek", author: "Strindberg", year: 1893, femaleCount: 4, totalCount: 4},
            {title: "Paria", author: "Strindberg", year: 1890, femaleCount: 0, totalCount: 2},
            {title: "Samum", author: "Strindberg", year: 1890, femaleCount: 1, totalCount: 3},
            {title: "Till Damaskus", author: "Strindberg", year: 1898, femaleCount: 15, totalCount: 47},
            {title: "I små maffarnas land", author: "Topelius", year: 1897, femaleCount: 1, totalCount: 4},
            {title: "Jeppe och Murra", author: "Topelius", year: 1897, femaleCount: 1, totalCount: 2},
            {title: "Askungen", author: "Topelius", year: 1890, femaleCount: 8, totalCount: 13},
            {title: "Jennys förmaningar", author: "Topelius", year: 1887, femaleCount: 1, totalCount: 3},
            {title: "Krypskyttarne", author: "Topelius", year: 1886, femaleCount: 0, totalCount: 3},
            {title: "Lucias ziffror", author: "Topelius", year: 1887, femaleCount: 10, totalCount: 14},
            {title: "Perdita", author: "Topelius", year: 1896, femaleCount: 2, totalCount: 9},
            {title: "Skogskonungen", author: "Topelius", year: 1896, femaleCount: 4, totalCount: 10},
            {title: "Snurran", author: "Topelius", year: 1896, femaleCount: 9, totalCount: 25},
            {title: "Station Sylvester", author: "Topelius", year: 1889, femaleCount: 11, totalCount: 34},
            {title: "Tidernas spegel", author: "Topelius", year: 1896, femaleCount: 5, totalCount: 5},
            {title: "På vakt", author: "Wahlenberg", year: 1890, femaleCount: 3, totalCount: 6},
            {title: "Två valspråk", author: "Wahlenberg", year: 1882, femaleCount: 7, totalCount: 11}
        ];

        // Calculate percentage of female speakers
        const data = plays.map(play => ({
            ...play,
            femalePercentage: (play.femaleCount / play.totalCount) * 100
        }));

        // Set up dimensions
        const margin = { top: 20, right: 30, bottom: 60, left: 70 };
        const width = 900 - margin.left - margin.right;
        const height = 500 - margin.top - margin.bottom;

        // Create SVG
        const svg = d3.select('#chart')
            .attr('width', width + margin.left + margin.right)
            .attr('height', height + margin.top + margin.bottom);

        const g = svg.append('g')
            .attr('transform', `translate(${margin.left},${margin.top})`);

        // Set up scales
        const xScale = d3.scaleLinear()
            .domain(d3.extent(data, d => d.year))
            .range([0, width]);

        const yScale = d3.scaleLinear()
            .domain([0, 100])
            .range([height, 0]);

        // Create grid lines
        g.selectAll('.grid-line-x')
            .data(xScale.ticks())
            .enter()
            .append('line')
            .attr('class', 'grid-line')
            .attr('x1', d => xScale(d))
            .attr('x2', d => xScale(d))
            .attr('y1', 0)
            .attr('y2', height);

        g.selectAll('.grid-line-y')
            .data(yScale.ticks())
            .enter()
            .append('line')
            .attr('class', 'grid-line')
            .attr('x1', 0)
            .attr('x2', width)
            .attr('y1', d => yScale(d))
            .attr('y2', d => yScale(d));

        // Create axes
        const xAxis = d3.axisBottom(xScale).tickFormat(d3.format('d'));
        const yAxis = d3.axisLeft(yScale).tickFormat(d => d + '%');

        g.append('g')
            .attr('class', 'axis')
            .attr('transform', `translate(0,${height})`)
            .call(xAxis);

        g.append('g')
            .attr('class', 'axis')
            .call(yAxis);

        // Add axis labels
        g.append('text')
            .attr('class', 'axis-label')
            .attr('transform', 'rotate(-90)')
            .attr('y', 0 - margin.left)
            .attr('x', 0 - (height / 2))
            .attr('dy', '1em')
            .style('text-anchor', 'middle')
            .text('Percentage of Female Speakers');

        g.append('text')
            .attr('class', 'axis-label')
            .attr('transform', `translate(${width / 2}, ${height + margin.bottom - 10})`)
            .style('text-anchor', 'middle')
            .text('Year');

        // Calculate trend line using linear regression
        const n = data.length;
        const sumX = d3.sum(data, d => d.year);
        const sumY = d3.sum(data, d => d.femalePercentage);
        const sumXY = d3.sum(data, d => d.year * d.femalePercentage);
        const sumXX = d3.sum(data, d => d.year * d.year);

        const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);
        const intercept = (sumY - slope * sumX) / n;

        const trendLine = d3.line()
            .x(d => xScale(d.year))
            .y(d => yScale(slope * d.year + intercept));

        const trendData = [
            {year: d3.min(data, d => d.year)},
            {year: d3.max(data, d => d.year)}
        ];

        g.append('path')
            .datum(trendData)
            .attr('class', 'trend-line')
            .attr('d', trendLine);

        // Create tooltip
        const tooltip = d3.select('#tooltip');

        // Add data points
        g.selectAll('.data-point')
            .data(data)
            .enter()
            .append('circle')
            .attr('class', 'data-point')
            .attr('cx', d => xScale(d.year))
            .attr('cy', d => yScale(d.femalePercentage))
            .attr('r', 6)
            .on('mouseover', function(event, d) {
                tooltip.style('opacity', 1)
                    .html(`
                        <strong>${d.title}</strong><br>
                        Author: ${d.author}<br>
                        Year: ${d.year}<br>
                        Female speakers: ${d.femaleCount}/${d.totalCount} (${d.femalePercentage.toFixed(1)}%)
                    `)
                    .style('left', (event.pageX + 10) + 'px')
                    .style('top', (event.pageY - 10) + 'px');
            })
            .on('mouseout', function() {
                tooltip.style('opacity', 0);
            });

        // Calculate and display statistics
        const avgPercentage = d3.mean(data, d => d.femalePercentage);
        const totalPlays = data.length;
        const yearRange = `${d3.min(data, d => d.year)}-${d3.max(data, d => d.year)}`;

        document.getElementById('avg-percentage').textContent = avgPercentage.toFixed(1) + '%';
        document.getElementById('total-plays').textContent = totalPlays;
        document.getElementById('year-range').textContent = yearRange;

        // Group data by year for better visualization
        const yearlyData = d3.group(data, d => d.year);
        const yearlyAverages = Array.from(yearlyData, ([year, plays]) => ({
            year,
            avgPercentage: d3.mean(plays, d => d.femalePercentage),
            playCount: plays.length
        }));

        // Populate play list
        const playsContent = document.getElementById('plays-content');
        data.sort((a, b) => a.year - b.year || a.title.localeCompare(b.title));
        
        data.forEach(play => {
            const playItem = document.createElement('div');
            playItem.className = 'play-item';
            playItem.innerHTML = `
                <div class="play-title">${play.title}</div>
                <div class="play-author">${play.author} (${play.year}) - ${play.femalePercentage.toFixed(1)}% female speakers</div>
            `;
            playsContent.appendChild(playItem);
        });

        // Add animation
        g.selectAll('.data-point')
            .style('opacity', 0)
            .transition()
            .duration(1000)
            .delay((d, i) => i * 20)
            .style('opacity', 1);

        g.select('.trend-line')
            .style('opacity', 0)
            .transition()
            .duration(1500)
            .delay(500)
            .style('opacity', 1);
    </script>
</body>
</html>